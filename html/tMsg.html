<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>參S數位學習網</title>
    <link rel="stylesheet" href="../css/HomePage.css">
    <link rel="stylesheet" href="../css/tMsg.css">
    <script src="../_js/jquery.min.js"></script>
    <script src="../_js/jquery-ui.min.js"></script>
    <script>
        $(document).ready(function() {
            $('#threeLine').click(function() {
                $('#menu').slideToggle().addClass("show");
            });
        });
        
        function random(n) {
            return Math.floor(Math.random() * n);
        }

        function say() {
            append("<div class='word_out'><div class='word_me'>" + document.getElementById("say").value + "</div></div>");
            answer();
        }

        function keyin(event) {
            var keyCode = event.which;
            if (keyCode == 13) say();
        }

        function append(line) {
            var dialogBox = document.getElementById("talk_win_content");
            dialogBox.innerHTML += line + "<br>\n";
            dialogBox.scrollTop = dialogBox.scrollHeight;
        }

        function answer() {
            setTimeout(function() {
                append("<div class='word_me'>" + getAnswer() + "</div>");
            }, 1000 + random(2000));
        }

        function getAnswer() {
            var say = document.getElementById("say").value;
            for (var i in qaList) {
                try {
                    var qa = qaList[i];
                    var qList = qa.Q.split("|");
                    var aList = qa.A.split("|");
                    for (var qi in qList) {
                        var q = qList[qi];
                        if (q == "")
                            return aList[random(aList.length)];
                        var r = new RegExp("(.*)" + q + "([^?.;]*)", "gi");
                        if (say.match(r)) {
                            tail = RegExp.$2;
                            tail = tail.replace("我", "#").replace("你", "我").replace("#", "你");
                            return aList[random(aList.length)].replace(/\*/, tail);
                        }
                    }
                } catch (err) {}
            }
            return "然後呢？";
        }
    </script>
</head>

<body>
    <div id="win">
        <div id="title">
            <div id="logo_title">
                <div id="pic_3">
                    <img id="plane3" src="../sourcesImage/logo.png" alt="">
                </div>
                <h1 id="h1">參S數位學習網</h1>
            </div>
            <div id="pic_menu">
                <img id="threeLine" src="../sourcesImage/threeLine.png" alt="">
            </div>
            <div id="menu">
                <div id="board">佈告欄</div>
                <div id="roll">點名</div>
                <div id="point">成績單</div>
                <div id="video">補帶</div>
                <div id="message">私訊</div>
                <div id="practice">課後練習</div>
            </div>
        </div>
        
        <div id="main">
            <div id="banner">
                <a href="tMsg_p.html">
                    <div id="p_btn">
                        <p class="btn_word">家長</p>
                    </div>
                </a>
                <a href="tMsg_s.html">
                    <div id="s_btn">
                        <p class="btn_word">學生</p>
                    </div>
                </a>
            </div>
            <div id="talk_win">
                <div id="talk_win_title">
                    <p id="name" class="btn_word">小明的媽媽</p>
                </div>
                <div id="talk_win_content">
                    <div class='word_out'>
                        <div class="word_me">您好，請問我該如何幫您？</div>
                    </div><br>
                </div>
                <div id="talk_win_input">
                    <input id="say" name="say" type="text" value="" size="80" onkeydown="keyin(event)" />
                    <input id="submit_btn" type="submit" value="傳送" onclick="say()" />
                </div>
            </div>
        </div>
        
    </div>
</body>

</html>